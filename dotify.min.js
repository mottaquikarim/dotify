$.widget("tk.dotify",{_options:{delimiter:"word"},_create:function(){var e=this;e.el=$(e.element);e.el.blast({delimiter:e.options.delimiter});e.blasts=e.el.find(".blast");e.idx=e.__binarySearch(e.blasts,e.el.height());if(e.idx===0)return;if(e.idx===e.blasts.length)return;e.__findAndSwapDots()},__binarySearch:function(e,t){var n=this;var r=0,i=e.length-1,s,o;while(r<=i){s=Math.floor((r+i)/2);var u=$(e[s]).position().top-n.el.position().top;if(u<t){r=s+1;continue}if(u>t){i=s-1;continue}return s}return r},__findAndSwapDots:function(){var e=this,t=$(e.blasts[e.idx-1]),n=$("<span/>"),r=t.width(),i=t.position().top-e.el.position().top,s=t.height(),o=e.el.height();if(s+i>o){var u=s+i-o;e.el.css("height",o+u)}for(var a=e.blasts.length;a>=e.idx;a--){var f=$(e.blasts[a]);f.hide()}n.attr("class","blast-dots").css({width:r+"px",overflow:"hidden"}).text("...");if(t.position().left+r+n.width()<=e.el.width()){t.append(n)}else{t.before(n);t.hide()}}})
